
<!-- saved from url=(0250)file:///C:/Users/vlad/Desktop/Test/%D0%A1%D1%82%D1%83%D0%B4%D0%B5%D0%BD%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F%20%D1%87%D0%B0%D1%81%D1%82%D1%8C%20-%20%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0%20%D1%8D%D0%BA%D0%B7%D0%B0%D0%BC%D0%B5%D0%BD%D0%B0.htm -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>
				localStorage.clear();
				localStorage.setItem("upd", 0);
			</script>
			


    
    <title>Студенческая часть - страница экзамена</title>
    <link rel="stylesheet" href="./index_files/main.css">
    <link rel="stylesheet" href="./index_files/student.css">
    <link href="./index_files/font-awesome.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" href="https://session.kgmu.kz/img/tab_icon.png" type="image/x-icon">
    <script src="./index_files/jquery-3.5.1.min.js.download"></script>
<style>._3emE9--dark-theme .-S-tR--ff-downloader{background:rgba(30,30,30,.93);border:1px solid rgba(82,82,82,.54);box-shadow:0 4px 7px rgba(30,30,30,.55);color:#fff}._3emE9--dark-theme .-S-tR--ff-downloader ._6_Mtt--header ._2VdJW--minimize-btn{background:#3d4b52}._3emE9--dark-theme .-S-tR--ff-downloader ._6_Mtt--header ._2VdJW--minimize-btn:hover{background:#131415}._3emE9--dark-theme .-S-tR--ff-downloader ._10vpG--footer{background:rgba(30,30,30,.93)}._2mDEx--white-theme .-S-tR--ff-downloader{background:#fff;border:1px solid rgba(82,82,82,.54);box-shadow:0 4px 7px rgba(30,30,30,.55);color:#314c75}._2mDEx--white-theme .-S-tR--ff-downloader ._6_Mtt--header{font-weight:700}._2mDEx--white-theme .-S-tR--ff-downloader ._2dFLA--container ._2bWNS--notice{border:0;color:rgba(0,0,0,.88)}._2mDEx--white-theme .-S-tR--ff-downloader ._10vpG--footer{background:#fff}.-S-tR--ff-downloader{display:block;overflow:hidden;position:fixed;bottom:20px;right:7.1%;width:330px;height:180px;background:rgba(30,30,30,.93);border-radius:2px;color:#fff;z-index:99999999;border:1px solid rgba(82,82,82,.54);box-shadow:0 4px 7px rgba(30,30,30,.55);transition:.5s}.-S-tR--ff-downloader._3M7UQ--minimize{height:62px}.-S-tR--ff-downloader._3M7UQ--minimize .nxuu4--file-info,.-S-tR--ff-downloader._3M7UQ--minimize ._6_Mtt--header{display:none}.-S-tR--ff-downloader ._6_Mtt--header{padding:10px;font-size:17px;font-family:sans-serif}.-S-tR--ff-downloader ._6_Mtt--header ._2VdJW--minimize-btn{float:right;background:#f1ecec;height:20px;width:20px;text-align:center;padding:2px;margin-top:-10px;cursor:pointer}.-S-tR--ff-downloader ._6_Mtt--header ._2VdJW--minimize-btn:hover{background:#e2dede}.-S-tR--ff-downloader ._13XQ2--error{color:red;padding:10px;font-size:12px;line-height:19px}.-S-tR--ff-downloader ._2dFLA--container{position:relative;height:100%}.-S-tR--ff-downloader ._2dFLA--container .nxuu4--file-info{padding:6px 15px 0;font-family:sans-serif}.-S-tR--ff-downloader ._2dFLA--container .nxuu4--file-info div{margin-bottom:5px;width:100%;overflow:hidden}.-S-tR--ff-downloader ._2dFLA--container ._2bWNS--notice{margin-top:21px;font-size:11px}.-S-tR--ff-downloader ._10vpG--footer{width:100%;bottom:0;position:absolute;font-weight:700}.-S-tR--ff-downloader ._10vpG--footer ._2V73d--loader{animation:n0BD1--rotation 3.5s linear forwards;position:absolute;top:-120px;left:calc(50% - 35px);border-radius:50%;border:5px solid #fff;border-top-color:#a29bfe;height:70px;width:70px;display:flex;justify-content:center;align-items:center}.-S-tR--ff-downloader ._10vpG--footer ._24wjw--loading-bar{width:100%;height:18px;background:#dfe6e9;border-radius:5px}.-S-tR--ff-downloader ._10vpG--footer ._24wjw--loading-bar ._1FVu9--progress-bar{height:100%;background:#8bc34a;border-radius:5px}.-S-tR--ff-downloader ._10vpG--footer ._2KztS--status{margin-top:10px}.-S-tR--ff-downloader ._10vpG--footer ._2KztS--status ._1XilH--state{float:left;font-size:.9em;letter-spacing:1pt;text-transform:uppercase;width:100px;height:20px;position:relative}.-S-tR--ff-downloader ._10vpG--footer ._2KztS--status ._1jiaj--percentage{float:right}</style></head>
<body class="exam_page">
    <div class="exam_wrap" style="z-index: 200;" hidden="">
        <div class="exam_container container" hidden="">
            <div class="exam_menu">
                <i class="fa fa-times"></i>
            </div>
            <p hidden="">Обнаружено нарушение! Вы покинули страницу 1 раз. В последний раз вы отсутствовали на странице в течение 8 секунд.</p>
        </div>
    </div>
    <header class="header_exam" style="position: static; margin-bottom: 40px;">
        <div>
		<p>
		</p>
            <!--<p>Просьба не перезагружать страницу и не переключаться по вкладкам!</p>-->
            <span id="ten-countdown">1:39:49</span>
        </div>
    </header>
    <div class="empty" style="height: 0px;"></div>
	 <form action="https://session.kgmu.kz/student/student_main.php" method="POST">
    <section class="exam container">	   
        <div class="info_set">
            <span data-gid="" id="dis_name"> Тестовая страница</span>
            <span data-sid="" data-tid="0" id="stud_name"></span>
        </div>
		        <div class="answer_for_question inner_container">
            <span>Вопрос №1 </span>
            <div class="question_text">
                <span>
                  Как называется наш университет:<br>

                </span>
            </div>
            <span class="application">Подсказка</span>
            <div class="gallery">
                            <div class="thumbs">
                							<img src="./index_files/1.jpg" alt="Картинка к вопросу">
						                </div>
            </div>
            <textarea name="answer_1" class="answer_text" id="answer_text_1" cols="30" rows="10" placeholder="Ответ"></textarea>
			
			<!--				<input id="file" type="file" name="maths_" class="file"></br>-->
				<input type="hidden" name="ans_1" value="">
				<input type="hidden" name="i" value="1">
				
        </div>
		        <div class="answer_for_question inner_container">
            <span>Вопрос №2 </span>
            <div class="question_text">
                <span>
                  В каком городе находится наш университет?<br>
                </span>
            </div>
            <span class="application">Подсказка</span>
            <div class="gallery">
                            <div class="thumbs">
                							<img src="./index_files/2.jpg" alt="Картинка к вопросу">
						                </div>
            </div>
            <textarea name="answer_2" class="answer_text" id="answer_text_2" cols="30" rows="10" placeholder="Ответ"></textarea>
			
			<!--				<input id="file" type="file" name="maths_" class="file"></br>-->
				<input type="hidden" name="ans_2" value="">
				<input type="hidden" name="i" value="2">
				
        </div>
		        <div class="answer_for_question inner_container">
            <span>Вопрос №3 </span>
            <div class="question_text">
                <span>
                  Зачем Вы хотите стать врачом?:<br>
                </span>
            </div>
                      
            <textarea name="answer_3" class="answer_text" id="answer_text_3" cols="30" rows="10" placeholder="Ответ"></textarea>
			
			<!--				<input id="file" type="file" name="maths_" class="file"></br>-->
				<input type="hidden" name="ans_3" value="">
				<input type="hidden" name="i" value="3">
				
        </div>
					<input type="hidden" name="main" value="">	
			<input type="hidden" name="l" value="2">				
			<input type="hidden" name="type" value="0">	
			<input type="hidden" name="g_id" value="">	
            <input class="button" name="send" id="notclicker" type="submit" value="Отправить">      
    </section>
	  </form>
	<div class="fadeBlock" align="center" style="display: none;">
        <div class="content"><img class="full" src="./index_files/student_exam.php" width="100%"></div>
    </div>
    <script src="./index_files/jquery.min.js.download"></script>
    <script>
        $(document).ready(function(){
            // Галерея
			$('img').on('click', function() {
                  if($(this).attr('class')==undefined || !$(this).attr('class').match(/full/)){
                      $('.fadeBlock > .content > img').attr('src',this.src);
                      $('.fadeBlock').fadeIn('fast');
                  }else{
                      $('.fadeBlock > .content > img').attr('src','');
                      $('.fadeBlock').fadeOut('fast');
                  }
            });
			
            let send_button = document.querySelector(".button");
            //Всплывающее окно с предоставлением определённой информации
            let modal_background = document.querySelector('.exam_wrap');
            let modal_window = document.querySelector('.exam_container');
            let modal_text = document.querySelector('.exam_container p');
            let exam_header = document.querySelector('.header_exam');
            let exam_menu = document.querySelector('.exam_menu i');
            let empty_box = document.querySelector('.empty');

            // Вывод всплывающего окна с предоставлением определённой информации
            function modal_show(text_value){
                exam_header.style.position = "static";
                exam_header.style.marginBottom = "40px";
                empty_box.style.height = "0";
                modal_background.hidden = !modal_background.hidden;
                modal_background.style.zIndex = "200";
                modal_window.hidden = !modal_window.hidden;
                modal_text.hidden = !modal_text.hidden;
                modal_text.innerText = text_value;
            }

            // Закрытие всплывающего окна с предоставлением определённой информации
            exam_menu.addEventListener("click", function () {
                exam_header.style.position = "fixed";
                empty_box.style.height = "120px";
                modal_background.hidden = !modal_background.hidden;
                modal_window.hidden = !modal_window.hidden;
                modal_text.hidden = !modal_text.hidden;
            });

            // Запрет на копирование информации с поля, содержащего текст вопроса
            let questions_fields = document.querySelectorAll(".question_text span");
            let number_of_try_copy = 0;
            questions_fields.forEach(function(questions_field) {
                questions_field.addEventListener("copy", function (event){
                    number_of_try_copy++;
                    let violation_text = "Не пытайтесь скопировать информацию!"; //Обнаружено " + number_of_try_copy + " попыток копирования.";
                    event.preventDefault();
                    modal_show(violation_text);
                });
            });

          // Отправка информации о нарушении в БД
          $(".question_text span").bind("copy", function(event){ // задаем функцию при попытке скопировать текст вопроса
            $.ajax({
              method: "POST", // метод HTTP, используемый для запроса
              url: "violation.php", // строка, содержащая URL адрес, на который отправляется запрос
              data: { // данные, которые будут отправлены на сервер
                st_id: +$("#stud_name").attr("data-sid"),
				g_id: +$("#dis_name").attr("data-gid"),
                type: +$("#stud_name").attr("data-tid"),
                copy: true
              },
              success: [function (msg) { // функции обратного вызова, которые вызываются если AJAX запрос выполнится успешно (если несколько функций, то необходимо помещать их в массив)
              }],
              statusCode: {
                200: function () { // выполнить функцию если код ответа HTTP 200
                  console.log("Ok");
                }
              }
            })
          });

          // Запрет на вставку информации в поля для заполнения ответа*/
         let number_of_try_paste = 0;
          let paste_fields_ids = [];
          let answer_fields = document.querySelectorAll(".answer_text");
          answer_fields.forEach(function(answer_field) {
              answer_field.addEventListener("paste", function (event){
                  number_of_try_paste++;
                  paste_fields_ids.push(answer_field.id);
                  let violation_text = "Не пытайтесь вставить информацию!"; // Обнаружено " + number_of_try_paste + " попыток вставки."
                  event.preventDefault();
                  modal_show(violation_text);
              });
          });

          // Отправка информации о нарушении в БД
            $(".answer_text").bind("paste", function(event){ // задаем функцию при попытке вставить информацию в поле для ответа
              $.ajax({
                method: "POST", // метод HTTP, используемый для запроса
                url: "violation.php", // строка, содержащая URL адрес, на который отправляется запрос
                data: { // данные, которые будут отправлены на сервер
                  st_id: +$("#stud_name").attr("data-sid"),
				  g_id: +$("#dis_name").attr("data-gid"),
                  type: +$("#stud_name").attr("data-tid"),
                  paste: true
                },
                success: [function (msg) { // функции обратного вызова, которые вызываются если AJAX запрос выполнится успешно (если несколько функций, то необходимо помещать их в массив)
                }],
                statusCode: {
                  200: function () { // выполнить функцию если код ответа HTTP 200
                    console.log("Ok");
                  }
                }
              })
            });
          //Отслеживание перемещения по вкладкам браузера
          let number_of_try_search_info = 0;
          let info_about_mistakes_try = [];
          let info_about_mistakes_time = [];
          let start_date;
          let end_date;
          //Отслеживание события ухода со страницы экзамена
          window.addEventListener('blur', function () {
              number_of_try_search_info++;
              info_about_mistakes_try.push(number_of_try_search_info);
              start_date = performance.now();
          });

          //Отслеживание события возвращения на страницу экзамена
          window.addEventListener('focus', function () {
              end_date = performance.now();
              let seconds = Math.round((end_date - start_date)/1000);
              info_about_mistakes_time.push(seconds);
              let all_time_of_failure = 0;
              for(let k = 0; k < info_about_mistakes_time.length; k++){
                  all_time_of_failure += info_about_mistakes_time[k];
              }
              let violation_text = "Обнаружено нарушение! Вы покинули страницу " + info_about_mistakes_try[info_about_mistakes_try.length-1] +
                  " раз. В последний раз вы отсутствовали на странице в течение " + info_about_mistakes_time[info_about_mistakes_time.length-1] + " секунд.";
              modal_show(violation_text);
          });

        // Отправка информации о нарушении в БД
            let start_date_database;
            let end_date_database;
            $(window).bind("blur", function(event){ // задаем функцию при попытке вставить информацию в поле для ответа
                start_date_database = performance.now();
            });
            $(window).bind("focus", function(event){ // задаем функцию при попытке вставить информацию в поле для ответа
              end_date_database = performance.now();
              let seconds = Math.round((end_date_database - start_date_database)/1000);
              $.ajax({
                method: "POST", // метод HTTP, используемый для запроса
                url: "", // строка, содержащая URL адрес, на который отправляется запрос
                data: { // данные, которые будут отправлены на сервер
                  st_id: +$("#stud_name").attr("data-sid"),
				  g_id: +$("#dis_name").attr("data-gid"),
                  type: +$("#stud_name").attr("data-tid"),
                  absence_time: seconds
                },
                success: [function (msg) { // функции обратного вызова, которые вызываются если AJAX запрос выполнится успешно (если несколько функций, то необходимо помещать их в массив)
                }],
                statusCode: {
                  200: function () { // выполнить функцию если код ответа HTTP 200
                    console.log("Ok");
                  }
                }
              })
            });
	          //Локальное хранилище
          answer_fields.forEach(function(answer_field) {
              let answer_field_id_for_paste = answer_field.id;
              answer_field.value = localStorage.getItem(answer_field_id_for_paste);
          });
          answer_fields.forEach(function(answer_field) {
              answer_field.addEventListener("keyup", function (event){
                  let answer_field_id = event.currentTarget.id;
                  let answer_field_value = event.currentTarget.value;
                  localStorage.setItem(answer_field_id, answer_field_value);
              });
          });
          /*send_button.addEventListener("click", function (event) {
              localStorage.clear();
          });*/

          // Заморозка времени
          function countdown( elementName, minutes, seconds )
          {
              var element, endTime, hours, mins, msLeft, time;

              function twoDigits( n )
              {
                  return (n <= 9 ? "0" + n : n);
              }

              function updateTimer()
              {
                  msLeft = endTime - (+new Date);
				  localStorage.setItem("num", String(msLeft/60000));

                  if ( msLeft < 1000 ) {
          alert("Время истекло! Отправьте ответы в течение 30 секунд!");
          var button=document.getElementById("clicker");
          setTimeout(function(){button.click()}, 30000);
                     /*element.innerHTML = "Время истекло!";*/
          			/*document.getElementById("clicker").click();*/
                  } else {
                      time = new Date( msLeft );
                      hours = time.getUTCHours();
                      mins = time.getUTCMinutes();
                      element.innerHTML = (hours ? hours + ':' + twoDigits( mins ) : mins) + ':' + twoDigits( time.getUTCSeconds() );
                      setTimeout( updateTimer, time.getUTCMilliseconds() + 500 );
                  }
              }
              element = document.getElementById( elementName );
              endTime = (+new Date) + 1000 * (60*minutes + seconds) + 500;
              updateTimer();
          }
		    let time_rest;
							time_rest = 100;
			          	setTimeout(function(){
				countdown( "ten-countdown", time_rest, 0);
			}, 50);           

        });
</script>



</body></html>